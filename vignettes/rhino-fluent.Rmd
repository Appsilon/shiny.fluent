---
title: "Tutorial: Build a Rhino application using shiny.fluent"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteEncoding{UTF-8}
  %\VignetteIndexEntry{Tutorial: Build a Rhino application using shiny.fluent}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  markdown: 
    wrap: sentence
---

This quick tutorial helps to build a basic RShiny application with the structure provided by the `Rhino` package and simultaneously using the `Shiny.fluent` package.
It introduces the user to the concepts of -

-   Rhino project structure for a RShiny application and get it running

-   Rendering a basic UI using `shiny.fluent` package

-   Building a basic module in Rhino project to perform an action using Shiny.fluent package functions ( for example, using a Checkbox on the UI )

## Let's install `rhino` first

We assume that you do not have `rhino` pre-installed.
In that case, here's how you can install the package ğŸ‘‡

``` r
install.packages("rhino")
```

ğŸ’¡To use the state of the art JavaScript and Sass development tools provided by Rhino, you'll need toÂ [install Node.js](https://nodejs.org/en/download/)Â (v12 or later) on your system.
Rhino will still work without Node.js but with some limitations (described inÂ [JavaScript](https://appsilon.github.io/rhino/articles/tutorial/create-your-first-rhino-app.html#add-javascript-code)Â andÂ [Sass](https://appsilon.github.io/rhino/articles/tutorial/create-your-first-rhino-app.html#add-custom-styles)Â sections of our docs).

## Create an initial `rhino` application

Now that you have the package installed, let's use `rhino` to create an initial application for us which we can use for the next steps of our project.

Creating a new Rhino application can be done in two ways - by using the **Create Project** functionality on RStudio IDE or by running **`rhino::init()`** function from the console.
We'll discuss more about this below ğŸ‘‡

### ğŸ‘‰ Create an application using the RStudio wizard

If you use RStudio, probably the easiest way to create a new Rhino application is to simply use Create `New Project` feature.
Once Rhino is installed, it will be automatically added as one of the options in RStudio:

Choose it, input the new project name and you are ready to go ğŸ‘

![](https://appsilon.github.io/rhino/articles/tutorial/images/rstudio_wizard.png)

### ğŸ‘‰ Create an application usingÂ `rhino::init()`

Creating a Rhino application is possible in the R console by running theÂ `init`Â function:

``` r
rhino::init("RhinoApplication")
```

There are two things you need to know when choosing this way of initializing your application:

-   **Rhino willÂ notÂ change your working directory** - You need to either open a new R session in your new application directory or manually change the working directory.

```         
setwd("./RhinoApplication")
```

-   **Rhino relies on options added to the projectsÂ `.Rprofile`Â file -** The most robust way to make sure it was correctly sourced is to simply restart the R session.

A result of both paths will be an initial Rhino application with the following structure:

```         
.
â”œâ”€â”€ RhinoApplication.Rproj
â”œâ”€â”€ app
â”‚ â”œâ”€â”€ js
â”‚ â”‚ â””â”€â”€ index.js
â”‚ â”œâ”€â”€ logic
â”‚ â”‚ â””â”€â”€ __init__.R
â”‚ â”œâ”€â”€ main.R
â”‚ â”œâ”€â”€ static
â”‚ â”‚ â””â”€â”€ favicon.ico
â”‚ â”œâ”€â”€ styles
â”‚ â”‚ â””â”€â”€ main.scss
â”‚ â””â”€â”€ view
â”‚     â””â”€â”€ __init__.R
â”œâ”€â”€ app.R
â”œâ”€â”€ config.yml
â”œâ”€â”€ dependencies.R
â”œâ”€â”€ renv.lock
â”œâ”€â”€ rhino.yml
â””â”€â”€ tests
    â”œâ”€â”€ cypress
    â”‚ â””â”€â”€ integration
    â”‚     â””â”€â”€ app.spec.js
    â”œâ”€â”€ cypress.json
    â””â”€â”€ testthat
        â””â”€â”€ test-main.R
```

If you want to know more about it, checkÂ [this](https://appsilon.github.io/rhino/articles/explanation/application-structure.html)Â document.

### ğŸš€ Running the initial application

Now, once you are all set up, let's run it:

```         
shiny::runApp()
```

And here is what you should be seeing right now ğŸ‘‡

![](https://appsilon.github.io/rhino/articles/tutorial/images/init_application.png){width="620" height="268"}

## Let's install `shiny.fluent` for our project

ğŸ’¡The rhino project you just started uses `renv` for dependency management.
You can now install any other package in the same project and include it in the `renv.lock` file.

Here's how you can install the `shiny.fluent` package ğŸ‘‡

``` r
install.packages("shiny.fluent")
```

Now that the package is installed, let us use it for building our very first `rhino` module.

## Use `shiny.fluent` in your Rhino application!

In Rhino, each application view is intended to live as aÂ [Shiny module](https://shiny.rstudio.com/articles/modules.html)Â and use encapsulation provided byÂ [`box`Â package](https://klmr.me/box/).
Also, in rhino apps, even the base ui and server are modules!

In your project, please go to the `app` folder and edit the `main.R` file with the code below

``` r
# app/main.R

box::use(
  shiny[bootstrapPage, moduleServer, NS, tags, textOutput, renderText],
  shiny.fluent[fluentPage]
)

#' @export
# Define user interface function
ui <- function(id) {
  # Create namespace for UI elements
  ns <- NS(id)
  # Define app layout using Fluent UI design system
  fluentPage(
    tags$h1(
      textOutput(ns("message")) # Display message generated by server
    )
  )
}

#' @export
# Define server logic function
server <- function(id) {
  # Create Shiny module
  moduleServer(id, function(input, output, session) {
    # Generate message to be displayed in UI
    output$message <- renderText("ğŸ‘‹ This text has been generated using shiny.fluent package inside a Rhino project!")
  })
}
```

The **`box::use`** function is used to load the necessary packages along with their required functions for the app.
In this case, the app requires the **`shiny`** package for the basic Shiny functionalities and the **`shiny.fluent`** package for the Fluent UI design system.

The **`ui`** function creates the user interface of the app.
It takes an **`id`** argument which is used to namespace the UI elements.
Inside the function, the **`NS`** function is called to create the namespace for the UI elements.
The **`fluentPage`** function which is from `shiny.fluent` package is used to create the layout of the app.
It consists of a heading (**`tags$h1`**) and a text output (**`textOutput`**) element that will display a message generated by the server.
Fluent UI is a design system developed by Microsoft that provides a modern, responsive, and accessible user interface for web applications.

The **`server`** function defines the server logic of the app.
It takes an **`id`** argument which is used to match the namespace with the UI elements created in the **`ui`** function.
Inside the function, the **`moduleServer`** function is called to create a Shiny module.
The **`renderText`** function is used to generate the text output message that will be displayed in the UI.

The exported **`ui`** and **`server`** functions can be used to run the app with the **`shinyApp`** function.
The app will display a heading and a message that says "ğŸ‘‹ This text has been generated using shiny.fluent package inside a Rhino project!" in the web browser.

Upon running the app with `shiny::runApp()`, you should see the following on your screen!

```{r, echo=FALSE}
knitr::include_graphics("images/rhino_fluent_1.png")
```

## Adding modules to the Rhino App

Your application runs, but it doesn't have any meaningful functionality.
Let's add something there!

In Rhino, each application view is intended to live as aÂ [Shiny module](https://shiny.rstudio.com/articles/modules.html)Â and use encapsulation provided byÂ [`box`Â package](https://klmr.me/box/).

We will now try to code a module that basically creates a checkbox and shows values once checked or unchecked.

Rhino already created a good place for new modules, theÂ `app/view`Â directory.
So, create a file there, namedÂ `checkbox.R` and paste the following code there -

``` r
# app/view/checkbox.R

box::use(
  shiny[moduleServer, NS, tags, textOutput, renderText, markdown], # Load shiny package and specific functions
  shiny.fluent[fluentPage, Checkbox.shinyInput]  # Load shiny.fluent package and specific functions
)

#' @export
ui <- function(id) {
  ns <- NS(id)  # Create namespace for the app
  fluentPage(  # Create a Fluent UI page
    markdown("The `checkbox` module works! ğŸ‰"),  # Add markdown text to the page
    tags$h2(  # Create a heading
      Checkbox.shinyInput(ns("checkbox"), value = TRUE),  # Add a checkbox input with a default value of TRUE
      textOutput(ns("checkboxValue"))  # Add a text output that will display the checkbox value
    )
  )
}

#' @export
server <- function(id) {
  moduleServer(id, function(input, output, session) {  # Define a module server function that takes in input, output, and session arguments
    output$checkboxValue <- renderText({  # Render the text output based on the input checkbox value
        sprintf("Value: %s", input$checkbox)
      })  
  })
}
```

Within the **`ui`** function, we use **`fluentPage`** to create a Fluent UI page.
We then add a **`markdown`** text element to the page, followed by an **`h2`** heading that contains a checkbox input and a text output element.

The checkbox input is created using the **`Checkbox.shinyInput`** function from the **`shiny.fluent`** package.
We give the checkbox a unique ID by passing **`ns("checkbox")`** as the first argument, which uses the namespace we created earlier.
We also set a default value of **`TRUE`** for the checkbox.

The text output element is created using the **`textOutput`** function from the **`shiny`** package.
We give it a unique ID using **`ns("checkboxValue")`**, which again uses the namespace we created earlier.

The `server` all these UI components once the `checkbox` module is called by the main script.
So, now we will need to call the `checkbox` module in the `app/main.R` file.
Notice how we have modified the code that we wrote earlier to get started -

``` r
# app/main.R

# Load necessary packages
box::use(
  shiny[moduleServer, NS, tags, textOutput, renderText],
  shiny.fluent[fluentPage]
)

# we need to call the checkbox module here
box::use(
  app/view/checkbox,
)

#' @export
# Define user interface function
ui <- function(id) {
  # Create namespace for UI elements
  ns <- NS(id)
  # Define app layout using Fluent UI design system
  fluentPage(
    tags$h1(
      textOutput(ns("message")) # Display message generated by server
    ),
    checkbox$ui(ns("checkbox"))  # this includes the UI rendered by the app/view/checkbox.R file
  )
}

#' @export
# Define server logic function
server <- function(id) {
  # Create Shiny module
  moduleServer(id, function(input, output, session) {
    # Generate message to be displayed in UI
    output$message <- renderText("ğŸ‘‹ This text has been generated using shiny.fluent package inside a Rhino project!")
    checkbox$server("checkbox")

  })
}
```

Did you notice the part that mentions `box::use(â€¦` to call the module we created above? This makes sure that when we use `checkbox$ui(ns("checkbox"))` in the `fluentPage` section of UI and use `checkbox$server("checkbox")` in the `server`, all desired results are rendered on the app.

Cool!
Let us now run the app.
Keep your fingers crossed and run `shiny::runApp()` from the console!\
You must be seeing something like this ğŸ‘‡

```{r, echo=FALSE}
knitr::include_graphics("images/rhino_fluent_2.gif")
```

Notice that the value changes to FALSE once the checkbox is checked and viceversa.\

Congratulations, you have just learnt how to code Rhino modules with Shiny fluent!
ğŸš€

## Further Readings

This tutorial has enabled you to get started with a `Rhino` project structure for RShiny apps and using `Shiny.fluent` package to render features on the UI.
Next steps would be to add more features with modules in your application.

Please consider these resources to go to the next steps!

-   [All about Rhino](https://appsilon.com/rhino-r-package-tutorial/)

-   [Reference for all Shiny.fluent functions](https://appsilon.github.io/shiny.fluent/reference/index.html)

-   [How to use shiny.fluent with Shiny modules](https://appsilon.github.io/shiny.fluent/articles/sz-how-to-shiny-modules.html)

-   [Tutorial: Create your first shiny.fluent dashboard](https://appsilon.github.io/shiny.fluent/articles/shiny-fluent.html)

-   [Tutorial: Full dashboard UI in Shiny and Fluent](https://appsilon.github.io/shiny.fluent/articles/st-sales-reps-dashboard.html)

------------------------------------------------------------------------

Developed withÂ â¤ï¸Â byÂ [Appsilon](https://appsilon.com/).
