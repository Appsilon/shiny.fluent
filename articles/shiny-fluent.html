<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial: Create your first shiny.fluent dashboard • shiny.fluent</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Tutorial: Create your first shiny.fluent dashboard">
<meta property="og:description" content="shiny.fluent">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-DL2H66RTY1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DL2H66RTY1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shiny.fluent</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/shiny-fluent.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/st-sales-reps-dashboard.html">Tutorial: Full dashboard UI in Shiny and Fluent</a>
    </li>
    <li>
      <a href="../articles/sz-how-to-shiny-modules.html">How to: use shiny.fluent with Shiny modules</a>
    </li>
    <li>
      <a href="../articles/sz-how-to-troubleshoot.html">How to: troubleshoot shiny.react apps</a>
    </li>
    <li>
      <a href="../articles/sz-how-to-use-fluent-docs.html">Topic guide: Using Fluent components documentation</a>
    </li>
    <li>
      <a href="../articles/topic_react-in-shiny.html">Topic guide: React in Shiny</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/appsilon/shiny.fluent/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="shiny-fluent_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tutorial: Create your first shiny.fluent dashboard</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/appsilon/shiny.fluent/blob/master/vignettes/shiny-fluent.Rmd"><code>vignettes/shiny-fluent.Rmd</code></a></small>
      <div class="hidden name"><code>shiny-fluent.Rmd</code></div>

    </div>

    
    
<p>Let’s learn shiny.fluent by building an example app.</p>
<p>In this tutorial, we’ll build a basic application for analysing sales results data. The app will allow for filtering the data, and viewing it on a plot, on a map and in a table.</p>
<p>We’ll assume that you have <a href="https://shiny.rstudio.com/">Shiny</a> and <code>shiny.fluent</code> <a href="https://appsilon.github.io/shiny.fluent/#installation">already installed</a>.</p>
<div id="shiny-fluent-hello-world-app" class="section level1">
<h1 class="hasAnchor">
<a href="#shiny-fluent-hello-world-app" class="anchor"></a>shiny.fluent “Hello world!” app</h1>
<p>Let’s start by creating an app that shows “Hello world!”, but does this with Fluent UI. First, we need to load <code>shiny.fluent</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.rstudio.com/">shiny</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://appsilon.github.io/shiny.fluent">shiny.fluent</a></span><span class="op">)</span></code></pre></div>
<p>That gives us all we need to run a basic application! To create a UI showing a welcome message, we will use a Fluent component named <code><a href="../reference/Text.html">?Text</a></code>. We’ll put it in a <code><a href="../reference/fluentPage.html">?fluentPage</a></code>, which will add proper CSS classes and suppress Bootstrap (you should not use both Bootstrap and Fluent UI at the same time).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fluentPage.html">fluentPage</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/Text.html">Text</a></span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"xxLarge"</span>, <span class="st">"Hello world!"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>Let’s see what our app looks like right now.</p>
<p><img src="images/tutorial-part1-step1.png"><!-- --></p>
<p>Yay! It may not look very impressive, but this text is rendered in Shiny with the whole power of Fluent UI and <a href="https://reactjs.org">React</a>.</p>
</div>
<div id="showing-data-in-a-table" class="section level1">
<h1 class="hasAnchor">
<a href="#showing-data-in-a-table" class="anchor"></a>Showing data in a table</h1>
<p>Let’s now grab some data and show it to our users in a table. shiny.fluent already includes some example data that we can use.</p>
<p><code>fluentPeople</code> is a list of imaginary people in a format expected by some Fluent components.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fluentPeople</span> <span class="op">%&gt;%</span> <span class="fu">glimpse</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Rows: 7</span>
<span class="co">#&gt; Columns: 11</span>
<span class="co">#&gt; $ key           &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7</span>
<span class="co">#&gt; $ imageUrl      &lt;chr&gt; "https://static2.sharepointonline.com/files/fabric/offic…</span>
<span class="co">#&gt; $ imageInitials &lt;chr&gt; "PV", "AR", "AL", "RK", "CB", "VL", "MS"</span>
<span class="co">#&gt; $ text          &lt;chr&gt; "Annie Lindqvist", "Aaron Reid", "Alex Lundberg", "Roko …</span>
<span class="co">#&gt; $ secondaryText &lt;chr&gt; "Senior Sales Rep", "Sales Rep", "Junior Sales Rep", "Se…</span>
<span class="co">#&gt; $ tertiaryText  &lt;chr&gt; "In a meeting", "In a meeting", "In a meeting", "In a me…</span>
<span class="co">#&gt; $ optionalText  &lt;chr&gt; "Available at 4:00pm", "Available at 4:00pm", "Available…</span>
<span class="co">#&gt; $ isValid       &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE</span>
<span class="co">#&gt; $ presence      &lt;dbl&gt; 2, 6, 4, 1, 2, 2, 3</span>
<span class="co">#&gt; $ canExpand     &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA</span>
<span class="co">#&gt; $ color         &lt;chr&gt; "#8DD3C7", "#FFFFB3", "#BEBADA", "#FB8072", "#80B1D3", "…</span></code></pre></div>
<p><code>fluentSalesData</code> is a data frame of randomly generated “sales deals”, which are assigned to one of the <code>fluentPeople</code>, have a date and an amount, and are associated with one of the top 10 companies from the Fortune 500 list (including its name, city and map coordinates).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fluentSalesDeals</span> <span class="op">%&gt;%</span> <span class="fu">glimpse</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Rows: 100</span>
<span class="co">#&gt; Columns: 30</span>
<span class="co">#&gt; $ X           &lt;dbl&gt; -8286952, -13595427, -13625773, -13595427, -8286952, -8234…</span>
<span class="co">#&gt; $ Y           &lt;dbl&gt; 4938582, 6047180, 4550281, 6047180, 4938582, 4976415, 4938…</span>
<span class="co">#&gt; $ FID         &lt;dbl&gt; 493, 234, 425, 234, 493, 333, 493, 284, 333, 284, 425, 234…</span>
<span class="co">#&gt; $ OBJECTID    &lt;dbl&gt; 493, 234, 425, 234, 493, 333, 493, 284, 333, 284, 425, 234…</span>
<span class="co">#&gt; $ RANK        &lt;dbl&gt; 35, 28, 25, 28, 35, 21, 35, 26, 21, 26, 25, 28, 28, 21, 21…</span>
<span class="co">#&gt; $ NAME        &lt;chr&gt; "JOHNSON &amp; JOHNSON", "MICROSOFT", "WELLS FARGO", "MICROSOF…</span>
<span class="co">#&gt; $ ADDRESS     &lt;chr&gt; "1 JOHNSON AND JOHNSON PLAZA", "1 MICROSOFT WAY", "420 MON…</span>
<span class="co">#&gt; $ ADDRESS2    &lt;chr&gt; "NOT AVAILABLE", "NOT AVAILABLE", "NOT AVAILABLE", "NOT AV…</span>
<span class="co">#&gt; $ CITY        &lt;chr&gt; "NEW BRUNSWICK", "REDMOND", "SAN FRANCISCO", "REDMOND", "N…</span>
<span class="co">#&gt; $ STATE       &lt;chr&gt; "NJ", "WA", "CA", "WA", "NJ", "NY", "NJ", "NC", "NY", "NC"…</span>
<span class="co">#&gt; $ ZIP         &lt;chr&gt; "08933", "98052", "94163", "98052", "08933", "10017", "089…</span>
<span class="co">#&gt; $ COUNTY      &lt;chr&gt; "MIDDLESEX", "KING", "SAN FRANCISCO", "KING", "MIDDLESEX",…</span>
<span class="co">#&gt; $ EMPLOYEES   &lt;dbl&gt; 126400, 114000, 269100, 114000, 126400, 243355, 126400, 20…</span>
<span class="co">#&gt; $ REVENUES    &lt;dbl&gt; 71890, 85320, 94176, 85320, 71890, 105486, 71890, 93662, 1…</span>
<span class="co">#&gt; $ LATITUDE    &lt;dbl&gt; 40.49804, 47.64005, 37.79340, 47.64005, 40.49804, 40.75598…</span>
<span class="co">#&gt; $ LONGITUDE   &lt;dbl&gt; -74.44296, -122.12980, -122.40240, -122.12980, -74.44296, …</span>
<span class="co">#&gt; $ SOURCE      &lt;chr&gt; "MANUAL", "BING MAPS", "BING MAPS", "BING MAPS", "MANUAL",…</span>
<span class="co">#&gt; $ PRC         &lt;chr&gt; "ON-ENTITY", "ADDRESS", "ADDRESS", "ADDRESS", "ON-ENTITY",…</span>
<span class="co">#&gt; $ COUNTYFIPS  &lt;chr&gt; "34023", "53033", "06075", "53033", "34023", "36061", "340…</span>
<span class="co">#&gt; $ COMMENTS    &lt;chr&gt; "NOT AVAILABLE", "NOT AVAILABLE", "NOT AVAILABLE", "NOT AV…</span>
<span class="co">#&gt; $ WEBSITE     &lt;chr&gt; "HTTPS://WWW.JNJ.COM/", "HTTPS://WWW.MICROSOFT.COM/EN-US/"…</span>
<span class="co">#&gt; $ PROFIT      &lt;dbl&gt; 16540, 16798, 21938, 16798, 16540, 24733, 16540, 17906, 24…</span>
<span class="co">#&gt; $ deal_amount &lt;dbl&gt; 855987, 753174, 702208, 590190, 405443, 714723, 455713, 80…</span>
<span class="co">#&gt; $ rep_id      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2…</span>
<span class="co">#&gt; $ rep_name    &lt;chr&gt; "Annie Lindqvist", "Annie Lindqvist", "Annie Lindqvist", "…</span>
<span class="co">#&gt; $ date        &lt;date&gt; 2020-02-19, 2020-08-18, 2020-10-14, 2020-02-23, 2020-10-1…</span>
<span class="co">#&gt; $ client_name &lt;chr&gt; "JOHNSON &amp; JOHNSON", "MICROSOFT", "WELLS FARGO", "MICROSOF…</span>
<span class="co">#&gt; $ city        &lt;chr&gt; "NEW BRUNSWICK", "REDMOND", "SAN FRANCISCO", "REDMOND", "N…</span>
<span class="co">#&gt; $ color       &lt;chr&gt; "#8DD3C7", "#8DD3C7", "#8DD3C7", "#8DD3C7", "#8DD3C7", "#8…</span>
<span class="co">#&gt; $ is_closed   &lt;int&gt; 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1…</span></code></pre></div>
<p>We now need a Fluent component to insert a table. A good way find a component that suits our needs is to go to <a href="https://demo.appsilon.ai/apps/fluentui">shiny.fluent components live demo</a> or to the <a href="https://developer.microsoft.com/en-us/fluentui#/controls">official Fluent UI docs</a>. Browsing through the list of components, we find <code><a href="../reference/DetailsList.html">?DetailsList</a></code>, which gives a table component with rich configuration options.</p>
<p>First, we need to define which columns from our deals data we want to see and how to label them.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">details_list_columns</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  fieldName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rep_name"</span>, <span class="st">"date"</span>, <span class="st">"deal_amount"</span>, <span class="st">"client_name"</span>, <span class="st">"city"</span>, <span class="st">"is_closed"</span><span class="op">)</span>,
  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sales rep"</span>, <span class="st">"Close date"</span>, <span class="st">"Amount"</span>, <span class="st">"Client"</span>, <span class="st">"City"</span>, <span class="st">"Is closed?"</span><span class="op">)</span>,
  key <span class="op">=</span> <span class="va">fieldName</span><span class="op">)</span></code></pre></div>
<p>Let’s now display our sales deals in a table. As we plan to later make the table change dynamically, we put it in a regular Shiny <code>uiOutput</code>. Let’s also assume that for now we want to filter out deals that have <code>is_closed</code> equal to <code>1</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fluentPage.html">fluentPage</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">uiOutput</a></span><span class="op">(</span><span class="st">"analysis"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">filtered_deals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html">reactive</a></span><span class="op">(</span><span class="op">{</span>
    <span class="va">filtered_deals</span> <span class="op">&lt;-</span> <span class="va">fluentSalesDeals</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">is_closed</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>

  <span class="va">output</span><span class="op">$</span><span class="va">analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
    <span class="va">items_list</span> <span class="op">&lt;-</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="fu">filtered_deals</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span>
      <span class="fu"><a href="../reference/DetailsList.html">DetailsList</a></span><span class="op">(</span>items <span class="op">=</span> <span class="fu">filtered_deals</span><span class="op">(</span><span class="op">)</span>, columns <span class="op">=</span> <span class="va">details_list_columns</span><span class="op">)</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="st">"No matching transactions."</span><span class="op">)</span>
    <span class="op">}</span>

    <span class="fu"><a href="../reference/Stack.html">Stack</a></span><span class="op">(</span>
      tokens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>childrenGap <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
      <span class="fu"><a href="../reference/Text.html">Text</a></span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"large"</span>, <span class="st">"Sales deals details"</span>, block <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>style<span class="op">=</span><span class="st">"max-height: 500px; overflow: auto"</span>, <span class="va">items_list</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p>In addition to <code><a href="../reference/DetailsList.html">?DetailsList</a></code> and <code><a href="../reference/Text.html">?Text</a></code>, in the code above we used <code><a href="../reference/Stack.html">?Stack</a></code>, which arranges elements in its area.</p>
<p><img src="images/tutorial-part1-step2.png"><!-- --></p>
</div>
<div id="adding-filtering" class="section level1">
<h1 class="hasAnchor">
<a href="#adding-filtering" class="anchor"></a>Adding filtering</h1>
<p>Okay, that already looks good! But it’s hard to explore these data without some filtering options - let’s add that now. We will start by adding an option to find transactions between selected dates.</p>
<p>We will use two <code><a href="../reference/DatePicker.html">?DatePicker</a></code> components to allow users to choose a date range. To make the selected dates available in the server function, we have two options:</p>
<ol style="list-style-type: decimal">
<li>The simple way. Use the <code>DatePicker.shinyInput</code> convenience wrapper, which provides an interface analogous to vanilla Shiny inputs: <code>inputId</code> and optional <code>value</code>.</li>
<li>The advanced way. Use the component directly and connect it to Shiny using its React interface: <code>onSelectDate</code> and <code>defaultValue</code> in this case.</li>
</ol>
<p>The second option is less convenient but might provide more power and flexibility in some cases. We’ll go with the first option in this tutorial, as the simplified interface is sufficient for our needs.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tag.html">tagList</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/DatePicker.html">DatePicker.shinyInput</a></span><span class="op">(</span><span class="st">"fromDate"</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">'2020/01/01'</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"From date"</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/DatePicker.html">DatePicker.shinyInput</a></span><span class="op">(</span><span class="st">"toDate"</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">'2020/12/31'</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"To date"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Let’s add the filters to our UI:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fluentPage.html">fluentPage</a></span><span class="op">(</span>
  <span class="va">filters</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">uiOutput</a></span><span class="op">(</span><span class="st">"analysis"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>In the server function of our application, we can now access the input values using the IDs we provided in the same way as with any other Shiny input. Let’s use the selected dates to apply additional filtering to the deals:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</span>
<span id="cb9-2"><a href="#cb9-2"></a>  filtered_deals &lt;-<span class="st"> </span><span class="kw">reactive</span>({</span>
<span id="cb9-3"><a href="#cb9-3"></a>    <span class="kw">req</span>(input<span class="op">$</span>fromDate)</span>
<span id="cb9-4"><a href="#cb9-4"></a>    filtered_deals &lt;-<span class="st"> </span>fluentSalesDeals <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(</span>
<span id="cb9-5"><a href="#cb9-5"></a>      date <span class="op">&gt;=</span><span class="st"> </span>input<span class="op">$</span>fromDate,</span>
<span id="cb9-6"><a href="#cb9-6"></a>      date <span class="op">&lt;=</span><span class="st"> </span>input<span class="op">$</span>toDate,</span>
<span id="cb9-7"><a href="#cb9-7"></a>      is_closed <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>    )</span>
<span id="cb9-9"><a href="#cb9-9"></a>  })</span></code></pre></div>
<p>This is what our application looks like now:</p>
<p><img src="images/tutorial-part1-step3.png"><!-- --></p>
</div>
<div id="more-filters" class="section level1">
<h1 class="hasAnchor">
<a href="#more-filters" class="anchor"></a>More filters</h1>
<p>Let’s add more filtering options to our app! We will use the following components:</p>
<ul>
<li>
<a href="../reference/PeoplePicker.html"><code>?NormalPeoplePicker</code></a> to limit the search to selected sales representatives,</li>
<li>
<code><a href="../reference/Slider.html">?Slider</a></code> to define a minimum deal size,</li>
<li>
<code><a href="../reference/Toggle.html">?Toggle</a></code> to show only the closed deals.</li>
</ul>
<p>In addition we’ll use <code><a href="../reference/Stack.html">?Stack</a></code> and <code><a href="../reference/Label.html">?Label</a></code> to visually arrange the filtering controls.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Stack.html">Stack</a></span><span class="op">(</span>
  tokens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>childrenGap <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/Stack.html">Stack</a></span><span class="op">(</span>
    horizontal <span class="op">=</span> <span class="cn">TRUE</span>,
    tokens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>childrenGap <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/DatePicker.html">DatePicker.shinyInput</a></span><span class="op">(</span><span class="st">"fromDate"</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">'2020/01/01'</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"From date"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/DatePicker.html">DatePicker.shinyInput</a></span><span class="op">(</span><span class="st">"toDate"</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">'2020/12/31'</span><span class="op">)</span>, label <span class="op">=</span> <span class="st">"To date"</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="../reference/Label.html">Label</a></span><span class="op">(</span><span class="st">"Filter by sales reps"</span>, className <span class="op">=</span> <span class="st">"my_class"</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/CompactPeoplePicker.html">NormalPeoplePicker.shinyInput</a></span><span class="op">(</span>
    <span class="st">"selectedPeople"</span>,
    class <span class="op">=</span> <span class="st">"my_class"</span>,
    options <span class="op">=</span> <span class="va">fluentPeople</span>,
    pickerSuggestionsProps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      suggestionsHeaderText <span class="op">=</span> <span class="st">'Matching people'</span>,
      mostRecentlyUsedHeaderText <span class="op">=</span> <span class="st">'Sales reps'</span>,
      noResultsFoundText <span class="op">=</span> <span class="st">'No results found'</span>,
      showRemoveButtons <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="../reference/Slider.html">Slider.shinyInput</a></span><span class="op">(</span><span class="st">"slider"</span>,
    value <span class="op">=</span> <span class="fl">0</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1000000</span>, step <span class="op">=</span> <span class="fl">100000</span>,
    label <span class="op">=</span> <span class="st">"Minimum amount"</span>,
    valueFormat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny.react/man/JS.html">JS</a></span><span class="op">(</span><span class="st">"function(x) { return '$' + x}"</span><span class="op">)</span>,
    snapToStep <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span>,
  <span class="fu"><a href="../reference/Toggle.html">Toggle.shinyInput</a></span><span class="op">(</span><span class="st">"closedOnly"</span>, value <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="st">"Include closed deals only?"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Now that we have multiple filtering controls, it would be a good idea to add some visual separation between them and the table. Let’s define a helper function to create Fluent UI cards:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">makeCard</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">title</span>, <span class="va">content</span>, <span class="va">size</span> <span class="op">=</span> <span class="fl">12</span>, <span class="va">style</span> <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>
    class <span class="op">=</span> <span class="fu">glue</span><span class="op">(</span><span class="st">"card ms-depth-8 ms-sm{size} ms-xl{size}"</span><span class="op">)</span>,
    style <span class="op">=</span> <span class="va">style</span>,
    <span class="fu"><a href="../reference/Stack.html">Stack</a></span><span class="op">(</span>
      tokens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>childrenGap <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
      <span class="fu"><a href="../reference/Text.html">Text</a></span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"large"</span>, <span class="va">title</span>, block <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
      <span class="va">content</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Now we can wrap the filters in a call to <code>makeCard()</code>. Additionally, we include a <code>style</code> tag to add some padding and margin to the cards created by our helper function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fluentPage.html">fluentPage</a></span><span class="op">(</span>
  <span class="va">tags</span><span class="op">$</span><span class="fu">style</span><span class="op">(</span><span class="st">".card { padding: 28px; margin-bottom: 28px; }"</span><span class="op">)</span>,
  <span class="fu">makeCard</span><span class="op">(</span><span class="st">"Filters"</span>, <span class="va">filters</span>, size <span class="op">=</span> <span class="fl">4</span>, style <span class="op">=</span> <span class="st">"max-height: 320px;"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">uiOutput</a></span><span class="op">(</span><span class="st">"analysis"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Let’s move our attention to the server function. We can access the values of the filtering controls using the provided IDs just like before.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</span>
<span id="cb13-2"><a href="#cb13-2"></a>  filtered_deals &lt;-<span class="st"> </span><span class="kw">reactive</span>({</span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="kw">req</span>(input<span class="op">$</span>fromDate)</span>
<span id="cb13-4"><a href="#cb13-4"></a>    selectedPeople &lt;-<span class="st"> </span>(</span>
<span id="cb13-5"><a href="#cb13-5"></a>      <span class="cf">if</span> (<span class="kw">length</span>(input<span class="op">$</span>selectedPeople) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) input<span class="op">$</span>selectedPeople</span>
<span id="cb13-6"><a href="#cb13-6"></a>      <span class="cf">else</span> fluentPeople<span class="op">$</span>key</span>
<span id="cb13-7"><a href="#cb13-7"></a>    )</span>
<span id="cb13-8"><a href="#cb13-8"></a>    minClosedVal &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">isTRUE</span>(input<span class="op">$</span>closedOnly)) <span class="dv">1</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a>    filtered_deals &lt;-<span class="st"> </span>fluentSalesDeals <span class="op">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="st">      </span><span class="kw">filter</span>(</span>
<span id="cb13-12"><a href="#cb13-12"></a>        rep_id <span class="op">%in%</span><span class="st"> </span>selectedPeople,</span>
<span id="cb13-13"><a href="#cb13-13"></a>        date <span class="op">&gt;=</span><span class="st"> </span>input<span class="op">$</span>fromDate,</span>
<span id="cb13-14"><a href="#cb13-14"></a>        date <span class="op">&lt;=</span><span class="st"> </span>input<span class="op">$</span>toDate,</span>
<span id="cb13-15"><a href="#cb13-15"></a>        deal_amount <span class="op">&gt;=</span><span class="st"> </span>input<span class="op">$</span>slider,</span>
<span id="cb13-16"><a href="#cb13-16"></a>        is_closed <span class="op">&gt;=</span><span class="st"> </span>minClosedVal</span>
<span id="cb13-17"><a href="#cb13-17"></a>      ) <span class="op">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">is_closed =</span> <span class="kw">ifelse</span>(is_closed <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>))</span>
<span id="cb13-19"><a href="#cb13-19"></a>  })</span></code></pre></div>
<p>Finally, let’s refactor the table output and wrap it in a card.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="fu">makeCard</span><span class="op">(</span><span class="st">"Top results"</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>style<span class="op">=</span><span class="st">"max-height: 500px; overflow: auto"</span>, <span class="va">items_list</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Our filtering is much more useful now!</p>
<p><img src="images/tutorial-part1-step4.png"><!-- --></p>
</div>
<div id="more-outputs" class="section level1">
<h1 class="hasAnchor">
<a href="#more-outputs" class="anchor"></a>More outputs</h1>
<p>We are not limited to shiny.fluent components - we can seamlessly use other libraries in our app! Let’s add a Plotly plot and a Leaflet map. We start by adding a <code>plotlyOutput()</code> to our UI:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fluentPage.html">fluentPage</a></span><span class="op">(</span>
  <span class="va">tags</span><span class="op">$</span><span class="fu">style</span><span class="op">(</span><span class="st">".card { padding: 28px; margin-bottom: 28px; }"</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/Stack.html">Stack</a></span><span class="op">(</span>
    tokens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>childrenGap <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, horizontal <span class="op">=</span> <span class="cn">TRUE</span>,
    <span class="fu">makeCard</span><span class="op">(</span><span class="st">"Filters"</span>, <span class="va">filters</span>, size <span class="op">=</span> <span class="fl">4</span>, style <span class="op">=</span> <span class="st">"max-height: 320px"</span><span class="op">)</span>,
    <span class="fu">makeCard</span><span class="op">(</span><span class="st">"Deals count"</span>, <span class="fu">plotlyOutput</span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">8</span>, style <span class="op">=</span> <span class="st">"max-height: 320px"</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html">uiOutput</a></span><span class="op">(</span><span class="st">"analysis"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>We also add a <code>leafletOutput()</code> to the UI generated in the server function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R">    <span class="fu"><a href="../reference/Stack.html">Stack</a></span><span class="op">(</span>
      tokens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>childrenGap <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, horizontal <span class="op">=</span> <span class="cn">TRUE</span>,
      <span class="fu">makeCard</span><span class="op">(</span><span class="st">"Top results"</span>, <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span>style<span class="op">=</span><span class="st">"max-height: 500px; overflow: auto"</span>, <span class="va">items_list</span><span class="op">)</span><span class="op">)</span>,
      <span class="fu">makeCard</span><span class="op">(</span><span class="st">"Map"</span>, <span class="fu">leafletOutput</span><span class="op">(</span><span class="st">"map"</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<p>Now we can add the following code to the server function to render a bar chart and a map:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">output</span><span class="op">$</span><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu">renderLeaflet</span><span class="op">(</span><span class="op">{</span>
    <span class="va">points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu">filtered_deals</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">LONGITUDE</span>, <span class="fu">filtered_deals</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">LATITUDE</span><span class="op">)</span>
    <span class="fu">leaflet</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">addProviderTiles</span><span class="op">(</span><span class="va">providers</span><span class="op">$</span><span class="va">Stamen.TonerLite</span>, options <span class="op">=</span> <span class="fu">providerTileOptions</span><span class="op">(</span>noWrap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">addMarkers</span><span class="op">(</span>data <span class="op">=</span> <span class="va">points</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>

  <span class="va">output</span><span class="op">$</span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu">renderPlotly</span><span class="op">(</span><span class="op">{</span>
    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">filtered_deals</span><span class="op">(</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">rep_name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu">geom_bar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">filtered_deals</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu">ylab</span><span class="op">(</span><span class="st">"Number of deals"</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu">xlab</span><span class="op">(</span><span class="st">"Sales rep"</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu">theme_light</span><span class="op">(</span><span class="op">)</span>
    <span class="fu">ggplotly</span><span class="op">(</span><span class="va">p</span>, height <span class="op">=</span> <span class="fl">300</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span></code></pre></div>
<p>Look at our dashboard now!</p>
<p><img src="images/tutorial-part1-step5.png"><!-- --></p>
</div>
<div id="the-end-result" class="section level1">
<h1 class="hasAnchor">
<a href="#the-end-result" class="anchor"></a>The end result</h1>
<p>In this tutorial we built a simple dashboard for exploring sales representatives data. We learned how to use shiny.fluent inputs and outputs, how to add components from other libraries and how to use Fluent UI capabilities for visually arranging the elements.</p>
<p><img src="images/tutorial-part1-final.gif"><!-- --></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Marek Rogala, Kamil Zyla.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
